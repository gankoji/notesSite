<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><style data-href="/styles.9b87e697c172e14543a6.css">.tippy-box[data-animation=shift-away][data-state=hidden]{opacity:0}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=top]{transform:translateY(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=bottom]{transform:translateY(-10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=left]{transform:translateX(10px)}.tippy-box[data-animation=shift-away][data-state=hidden][data-placement^=right]{transform:translateX(-10px)}</style><meta name="generator" content="Gatsby 2.24.89"/><link as="script" rel="preload" href="/webpack-runtime-686ea3609d93a4d6222a.js"/><link as="script" rel="preload" href="/framework-66ce1c6e8de1b4304605.js"/><link as="script" rel="preload" href="/app-c896d5c9f10e2f28f960.js"/><link as="script" rel="preload" href="/styles-29163f9dced6fe4a408a.js"/><link as="script" rel="preload" href="/component---node-modules-gatsby-theme-andy-src-templates-note-js-49a4cf68cd149593e30e.js"/><link as="fetch" rel="preload" href="/page-data\575a-final-exam\page-data.json" crossorigin="anonymous"/><link as="fetch" rel="preload" href="/page-data\app-data.json" crossorigin="anonymous"/></head><body><script>(function() { try {
  var mode = localStorage.getItem('theme-ui-color-mode');
  if (!mode) return
  document.body.classList.add('theme-ui-' + mode);
} catch (e) {} })();</script><div id="___gatsby"><style data-emotion-css="n0ecfm">body{color:var(--theme-ui-colors-text,#333);background-color:var(--theme-ui-colors-background,#fff);}</style><style data-emotion-css="1fthmpb">*{box-sizing:border-box;}body{margin:0;font-family:system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",sans-serif;line-height:1.5;font-weight:400;}</style><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion-css="bya3fr">.css-bya3fr{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100vh;min-height:100vh;}</style><style data-emotion-css="1ehwac2">.css-1ehwac2{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100vh;min-height:100vh;}</style><div class="css-1ehwac2"><header><style data-emotion-css="b38cxh">.css-b38cxh{border-bottom:1px solid;border-color:var(--theme-ui-colors-gray,#dadada);}</style><style data-emotion-css="bjpuxf">.css-bjpuxf{box-sizing:border-box;margin:0;min-width:0;padding-top:8px;padding-bottom:8px;padding-left:16px;padding-right:16px;border-bottom:1px solid;border-color:var(--theme-ui-colors-gray,#dadada);}</style><div class="css-bjpuxf"><style data-emotion-css="12j45zb">.css-12j45zb{font-weight:700;color:var(--theme-ui-colors-text,#333);-webkit-text-decoration:none;text-decoration:none;}</style><a class="css-12j45zb" href="/">Jake&#x27;s Notes</a></div></header><style data-emotion-css="lxqeq9">.css-lxqeq9{-webkit-flex:1;-ms-flex:1;flex:1;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;overflow-y:hidden;}@media screen and (min-width:768px){.css-lxqeq9{overflow-x:auto;}}</style><style data-emotion-css="1xopae2">.css-1xopae2{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex:1;-ms-flex:1;flex:1;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;overflow-y:hidden;}@media screen and (min-width:768px){.css-1xopae2{overflow-x:auto;}}</style><div class="css-1xopae2"><style data-emotion-css="9ms8w3">.css-9ms8w3{min-width:unset;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;-webkit-transition-duration:100px;transition-duration:100px;width:100%;}@media screen and (min-width:640px){.css-9ms8w3{width:100%;}}@media screen and (min-width:768px){.css-9ms8w3{-webkit-transition:width;transition:width;width:1152px;}}</style><style data-emotion-css="1806l1h">.css-1806l1h{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-width:unset;-webkit-box-flex:1;-webkit-flex-grow:1;-ms-flex-positive:1;flex-grow:1;-webkit-transition-duration:100px;transition-duration:100px;width:100%;}@media screen and (min-width:640px){.css-1806l1h{width:100%;}}@media screen and (min-width:768px){.css-1806l1h{-webkit-transition:width;transition:width;width:1152px;}}</style><div class="note-columns-container css-1806l1h"><style data-emotion-css="q7ai65">.css-q7ai65{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow-y:auto;max-width:100%;width:100%;left:0;right:-585px;}@media screen and (min-width:640px){.css-q7ai65{max-width:100%;width:100%;}}@media screen and (min-width:768px){.css-q7ai65{position:-webkit-sticky;position:sticky;max-width:100vw;width:576px;}}</style><style data-emotion-css="108dckd">.css-108dckd{box-sizing:border-box;margin:0;min-width:0;padding-left:16px;padding-right:16px;background-color:var(--theme-ui-colors-background,#fff);display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;overflow-y:auto;max-width:100%;width:100%;left:0;right:-585px;}@media screen and (min-width:640px){.css-108dckd{max-width:100%;width:100%;}}@media screen and (min-width:768px){.css-108dckd{position:-webkit-sticky;position:sticky;max-width:100vw;width:576px;}}</style><div class="note-container css-108dckd"><style data-emotion-css="qkbcne">.css-qkbcne{display:none;-webkit-transition:opacity;transition:opacity;-webkit-transition-duration:100px;transition-duration:100px;opacity:0;}@media screen and (min-width:640px){.css-qkbcne{display:none;}}@media screen and (min-width:768px){.css-qkbcne{display:block;}}</style><style data-emotion-css="1d4xrqf">.css-1d4xrqf{box-sizing:border-box;margin:0;min-width:0;display:none;-webkit-transition:opacity;transition:opacity;-webkit-transition-duration:100px;transition-duration:100px;opacity:0;}@media screen and (min-width:640px){.css-1d4xrqf{display:none;}}@media screen and (min-width:768px){.css-1d4xrqf{display:block;}}</style><div class="css-1d4xrqf"><style data-emotion-css="1557ki8">.css-1557ki8{position:absolute;z-index:10;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);-webkit-transform-origin:left;-ms-transform-origin:left;transform-origin:left;}</style><style data-emotion-css="1vxydnz">.css-1vxydnz{box-sizing:border-box;margin:0;min-width:0;padding-bottom:8px;position:absolute;z-index:10;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);-webkit-transform-origin:left;-ms-transform-origin:left;transform-origin:left;}</style><div class="css-1vxydnz"><style data-emotion-css="y5zp6v">.css-y5zp6v{font-weight:700;-webkit-text-decoration:none;text-decoration:none;color:var(--theme-ui-colors-text,#333);}</style><a class="css-y5zp6v" href="/\575a-final-exam/575a-final-exam">575a-final-exam</a></div></div><style data-emotion-css="1jnayfl">.css-1jnayfl{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100%;-webkit-transition:opacity;transition:opacity;-webkit-transition-duration:100px;transition-duration:100px;opacity:1;}</style><style data-emotion-css="1xvlbb1">.css-1xvlbb1{box-sizing:border-box;margin:0;min-width:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;min-height:100%;-webkit-transition:opacity;transition:opacity;-webkit-transition-duration:100px;transition-duration:100px;opacity:1;}</style><div class="css-1xvlbb1"><style data-emotion-css="1rr4qq7">.css-1rr4qq7{-webkit-flex:1;-ms-flex:1;flex:1;}</style><div class="css-1rr4qq7"><style data-emotion-css="1ebprri">.css-1ebprri{margin-top:16px;margin-bottom:16px;}</style><style data-emotion-css="xz3bt">.css-xz3bt{color:#333;font-family:inherit;line-height:1.125;font-weight:700;font-size:32px;margin-top:16px;margin-bottom:16px;}</style><h1 class="css-xz3bt">575a-final-exam</h1><style data-emotion-css="1ccy11i">.css-1ccy11i{color:#333;font-family:inherit;line-height:1.125;font-weight:700;font-size:32px;color:#333;font-family:inherit;line-height:1.125;font-weight:700;font-size:32px;}</style><h1 class="css-1ccy11i">Final Exam</h1><style data-emotion-css="19iowwu">.css-19iowwu{color:#333;color:#333;}</style><p class="css-19iowwu">As requested, I&#x27;m writing out my solution approaches to each of the five questions on the final exam shared with me: <style data-emotion-css="18ci6ln">.css-18ci6ln{color:#3182ce;-webkit-text-decoration:none;text-decoration:none;}.css-18ci6ln:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><style data-emotion-css="embvvb">.css-embvvb{color:#3182ce;padding-left:2px;padding-right:2px;margin-left:-2px;margin-right:-2px;border-radius:4px;color:#3182ce;-webkit-text-decoration:none;text-decoration:none;}.css-embvvb:hover{background-color:#fafafc;}.css-embvvb:focus{background-color:#fafafc;}.css-embvvb:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a class="css-embvvb" href="/\575a-final-exam/%5C2020-4-math-575a-final-exampdf">2020-4<strong class="css-0">math_575a</strong>final_exam.pdf</a>. </p><style data-emotion-css="cq6ij1">.css-cq6ij1{color:#333;font-family:inherit;line-height:1.125;font-weight:700;font-size:24px;color:#333;font-family:inherit;line-height:1.125;font-weight:700;font-size:24px;}</style><h2 class="css-cq6ij1">Quantization Effects</h2><p class="css-19iowwu">I&#x27;ll admit to being a bit stumped by this one. I don&#x27;t have an exact answer for why the step size is smaller on the log-log plot when the input is less than 1, but I would hazard a guess that it is due to truncation error of the repeated floating point operations (i.e. when the input is above 1, the square root is repeatedly decreasing the fraction, and thus we&#x27;re losing bits of precision off to the right, which don&#x27;t come back when squared). This effect on the fraction goes <em class="css-0">the other direction</em> when the input is less than zero, since square roots increase the magnitude of the fraction for those numbers. </p><p class="css-19iowwu">I found the width of the step size for $log_{10}(x)$ &#x27;empirically&#x27;, simply by running the map on a logspace of inputs and plotting input vs output. Matplotlib&#x27;s plots have a cursor which lets you &#x27;measure&#x27;, to a rough precision, points on the graph. The step shown below starts at roughly $x=1.6499$, and ends at $x=2.11526$, for a width of $0.46527$, or a logarithmic difference of  $0.10788$. </p><p class="css-19iowwu"><style data-emotion-css="1k89gbo">.css-1k89gbo{max-width:100%;max-width:100%;}</style><img src="%5C50shadesofrootspng" alt="50shadesofroots.png" class="css-1k89gbo"/></p><p class="css-19iowwu">Code and output for this answer is shown below. This (and all other code shown in this document) was run on Python 3.7.6, with NumPy 1.18.1, on a Windows 10 desktop machine with an AMD Ryzen 3900x, 12 cores @ 4.2 GHz, and 32 GB RAM. </p><style data-emotion-css="mwhsaa">.css-mwhsaa{font-family:Menlo,monospace;overflow-x:auto;font-family:Menlo,monospace;overflow-x:auto;}.css-mwhsaa code{color:inherit;}.css-mwhsaa code{color:inherit;}</style><pre class="css-mwhsaa"><style data-emotion-css="tej46y">.css-tej46y{font-family:Menlo,monospace;font-size:inherit;font-family:Menlo,monospace;font-size:inherit;}</style><code class="css-tej46y">## Question 1, quantization errors
## Map is ((x)^(1/(2**50)))^(2**50)
def weirdMap(x):
    for i in range(0,50):
        x = math.sqrt(x)
    
    for i in range(0,50):
        x = x**2

    return x

x = np.logspace(-1,1,10000)
y = [weirdMap(a) for a in x]
plt.loglog(x,y)
plt.show()

x1 = 1.64999
x2 = 2.11526

print(f&quot;Difference: {x2-x1}. Log Difference: {math.log10(x2/x1)}.&quot;)
</code></pre><pre class="css-mwhsaa"><code class="css-tej46y">Difference: 0.4652700000000001. Log Difference: 0.10788244475855745.
Total time for question 1: 0.20099949836730957.
</code></pre><h2 class="css-cq6ij1">Ring of Vibrating Masses</h2><p class="css-19iowwu">This is a classic problem in many degree of freedom vibrating systems, and is solved via an approach known as modal analysis. As suggested in the problem statement, we begin by writing the equations of motion in matrix form: Mx&#x27;&#x27; = Kx, where M and K are the mass and stiffness matrices, respectively. </p><pre class="css-mwhsaa"><code class="css-tej46y">M = diag(1,4,1,4,1,4,1,4,1,4,1,4);
K = [-2 1 0 0 0 0 0 0 0 0 0 1;
     1 -2 1 0 0 0 0 0 0 0 0 0;
     0 1 -2 1 0 0 0 0 0 0 0 0;
     ...
     1 0 0 0 0 0 0 0 0 0 1 -2];
</code></pre><p class="css-19iowwu">Then, we compute the mass normalized stiffness matrix, and solve the symmetric eigenvalue problem for this matrix to get the squared natural frequencies (the eigenvalues) and the mode shapes (the eigenvectors). </p><pre class="css-mwhsaa"><code class="css-tej46y">rootMinv = inv(chol(M));
K&#x27; = rootMinv*K*rootMinv;
D, V = eig(K&#x27;);
omega = sqrt(D);
omega
V

</code></pre><p class="css-19iowwu">INCOMPLETE: The exam sheet actually explicitly mentions that using built-ins for &#x27;solving eigenproblems&#x27; is disallowed. Thus, we have to write our own procedure for solving the symmetric eigenvalue problem. I think this is a good spot for me to hold up my hands and say &quot;hey, I&#x27;m only <em class="css-0">outlining</em> a solution process here, not solving the problem!&quot; To write said eigenproblem solver, I would fall back to my trusty reference &quot;Numerical Recipes: The Art of Scientific Computing&quot; by Press et al. Specifically, Chapter 11, section 4.2, pages 588-589, the QL method for tridiagonal matrices. </p><p class="css-19iowwu">This overall solution process (sans eigensolver) is exactly as given in section 4.3 of Inman&#x27;s &quot;Engineering Vibration&quot;, a classic text on the subject. </p><style data-emotion-css="jgtg8i">.css-jgtg8i{color:#333;font-family:inherit;line-height:1.125;font-weight:700;font-size:20px;color:#333;font-family:inherit;line-height:1.125;font-weight:700;font-size:20px;}</style><h3 class="css-jgtg8i">After Consultation...</h3><p class="css-19iowwu">I put together a solution using the eigensolver built-in to NumPy&#x27;s LinAlg library, just to show the method works. Code and output are listed below. </p><pre class="css-mwhsaa"><code class="css-tej46y">## Question 2: Modal Analysis
def question2():
    M = np.diag([1,4,1,4,1,4,1,4,1,4,1,4])
    K = np.array([[-2,1,0,0,0,0,0,0,0,0,0,1],
                  [1,-2,1,0,0,0,0,0,0,0,0,0],
                  [0,1,-2,1,0,0,0,0,0,0,0,0],
                  [0,0,1,-2,1,0,0,0,0,0,0,0],
                  [0,0,0,1,-2,1,0,0,0,0,0,0],
                  [0,0,0,0,1,-2,1,0,0,0,0,0],
                  [0,0,0,0,0,1,-2,1,0,0,0,0],
                  [0,0,0,0,0,0,1,-2,1,0,0,0],
                  [0,0,0,0,0,0,0,1,-2,1,0,0],
                  [0,0,0,0,0,0,0,0,1,-2,1,0],
                  [0,0,0,0,0,0,0,0,0,1,-2,1],
                  [1,0,0,0,0,0,0,0,0,0,1,-2]])

    K = -K
    rootMinv = np.linalg.inv(np.linalg.cholesky(M))
    Kbar = np.dot(np.dot(rootMinv, K), rootMinv)
    w, v = np.linalg.eig(Kbar)
    freqs = np.sqrt(w)
    freqs[::-1].sort()

    for i in range(0, len(freqs)):
        print(f&quot;Natural Frequency {i}: {freqs[i]}.&quot;)

t0 = time.time()
question2()
t1 = time.time()
print(f&quot;Total time for question 2: {t1-t0}&quot;)
</code></pre><pre class="css-mwhsaa"><code class="css-tej46y">Natural Frequency 0: 1.5811388300841898.
Natural Frequency 1: 1.5477867823892801.
Natural Frequency 2: 1.54778678238928.
Natural Frequency 3: 1.4667609958224272.
Natural Frequency 4: 1.4667609958224268.
Natural Frequency 5: 1.4142135623730956.
Natural Frequency 6: 0.7071067811865475.
Natural Frequency 7: 0.5904338922639883.
Natural Frequency 8: 0.590433892263988.
Natural Frequency 9: 0.3230419109976909.
Natural Frequency 10: 0.3230419109976909.
Natural Frequency 11: 5.268356063861754e-09.
Total time for question 2: 0.009000778198242188
</code></pre><h2 class="css-cq6ij1">Solution of System of Nonlinear Equations</h2><p class="css-19iowwu">Solving a system of nonlinear equations is, sadly, provably at least as difficult as solving an optimization problem. Sans an analytical solution, we are left with iterative methods. Globally convergent methods are generally desirable for this type of problem, and line search with backtracking is one such solution with good convergence properties. We are guaranteed with this method to converge to <em class="css-0">a</em> minimum of f = 1/2F(x)^2, where F is the vector valued function we seek to solve for F(x) = 0. However, we&#x27;re not guaranteed to find a zero, so we check for a false solution and start again from a new point if necessary. </p><p class="css-19iowwu">The common solution to this problem, although not necessarily the best in terms of performance or convergence guarantees, is the Newton-Rhapson method. This is the (admittedly simplistic or &#x27;easy way out&#x27;) solution that I present below. Here, F is the user supplied function to be zeroed, and J the user supplied function which outputs the Jacobian of said function with respect to its inputs. This solution follows nearly identically from section 9.6 of &quot;Numerical Recipes: The Art of Scientific Computing&quot; by Press et al. </p><pre class="css-mwhsaa"><code class="css-tej46y">def newtonRhapsonND(guess, F, J):
    xstar = np.zeros(guess.shape)
    xstar = guess
    ntrial = 100

    tolf = 1e-9
    tolx = 1e-9

    for k in range(0,ntrial):
        fvec = F(xstar)
        fjac = J(xstar)
        errf = np.sum(np.abs(fvec))
        if errf &lt; tolf:
            return xstar
        
        # Solve for next step
        # J*dx = -F
        dx = np.linalg.solve(fjac, -fvec)
        errx = np.sum(np.abs(dx))
        xstar += dx
        if errx &lt; tolx:
            return xstar

    return xstar
    
def myF(x):
    a = x[0]
    b = x[1]
    c = x[2]

    out = np.zeros((3,))

    out[0] = a - 3*b + 5*c - a**2 - b**2 - c**2
    out[1] = ((1/3.0)*a + (27.0/5.0)*b - (125.0/21.0)*c
            - 0.5*a**2 - (a + c)*b)
    out[2] = (-(1/15.0)*a + (27.0/7.0)*b + (125.0/9.0)*c
            - a*(b + c))
    return out

def myJac(x):
    fjac = np.zeros((3,3))
    fjac[0,0] = 1 - 2*x[0]
    fjac[0,1] = -3 - 2*x[1]
    fjac[0,2] = 5 - 2*x[2]
    fjac[1,0] = (1/3.0) - x[0]
    fjac[1,1] = (27.0/5.0) - (x[0] + x[2])
    fjac[1,2] = -(125.0/21.0) - x[1]
    fjac[2,0] = -(1/15.0) - (x[1] + x[2])
    fjac[2,1] = (27.0/7.0) - x[0]
    fjac[2,2] = (125.0/9.0) - x[0]

    return fjac

xstar = newtonRhapsonND(np.array([1.0,1.0, 1.0]), myF, myJac)
print(f&quot;Final optimal solution is ({xstar[0]}, {xstar[1]}, {xstar[2]}).&quot;)
</code></pre><p class="css-19iowwu">Output from NumPy:</p><pre class="css-mwhsaa"><code class="css-tej46y">Final solution is (0.9153081002598689, 0.024298671214824253, -0.0008064184960937964).
Total time for Newton-Rhapson: 0.0010061264038085938
</code></pre><h2 class="css-cq6ij1">Rocket Equation</h2><p class="css-19iowwu">This one is straightforward. This is a single spatial degree of freedom IVP, for which standard numerical ODE integration methods, such as Runge-Kutta, are more than appropriate. A method such as <code class="css-0">ode45</code> in MATLAB would allow us to simply give the set of ODEs as input (along with an option for the specified absolute tolerance), but that&#x27;s disallowed. Thus, we do it manually. The code below uses the constant time step fourth-order Runge-Kutta method, which is painfully easy to write. We use an iterative refinement loop to reach the specified accuracy.  </p><p class="css-19iowwu">We write out the equations of motion as the functions given in the problem statement:</p><pre class="css-mwhsaa"><code class="css-tej46y">def derivativesq4(t, yn):
    m = yn[0]
    v = yn[1]
    r = yn[2]
    dm = -1
    dv = 10 - m/(r**2)
    dr = v
    return np.array([dm, dv, dr])
</code></pre><p class="css-19iowwu">Then, we use the 4th order Runge-Kutta method to integrate the system:</p><pre class="css-mwhsaa"><code class="css-tej46y"># Fourth order Runge-Kutta solver
def integrate(yn1, tn1, dt, derivatives):
    k1 = dt*derivatives(tn1, yn1)
    k2 = dt*derivatives(tn1 + 0.5*dt, yn1 + 0.5*k1)
    k3 = dt*derivatives(tn1 + 0.5*dt, yn1 + 0.5*k2)
    k4 = dt*derivatives(tn1 + dt, yn1 + k3)

    yn = np.zeros((3,))
    for i in range(0,3):
        yn[i] = yn1[i] + (1/6.0)*k1[i] + (1/3.0)*k2[i] + (1/3.0)*k3[i] + (1/6.0)*k4[i]

    return yn
</code></pre><p class="css-19iowwu">Finally, we wrap the process in two loops. The inner loop simply iterates over the requisite number of time steps to reach the desired end time, given the current time step. The outer loop successively halves the time step until the difference between the final exit velocity from one loop iteration to the next is less than the specified error tolerance (in this case, we actually only need 1E-6, since the answer is of magnitude 1E2, but we go to 1E-8 to be thorough). </p><pre class="css-mwhsaa"><code class="css-tej46y">def question4():
    oldVe = 1e6
    currVe = 0
    eps = 1e-8

    dt = 2
    tf = 9
    nsteps = math.floor(tf/dt) + 1
    y = np.zeros((nsteps, 3))

    m0 = 10
    v0 = 0
    r0 = 1

    while (math.fabs(currVe - oldVe) &gt; eps):
        dt = dt/2
        nsteps = math.floor(tf/dt) + 1

        y = np.zeros((nsteps,3))
        time = np.linspace(0,tf, nsteps)
        y[0,0] = m0
        y[0,1] = v0
        y[0,2] = r0

        for i in range(1, nsteps):
            y[i] = integrate(y[i-1], time[i-1], dt, derivativesq4)

        oldVe = currVe
        currVe = math.sqrt(y[-1,1]**2 - (2/y[-1,2]))

    print(&quot;Final exit velocity: &quot; + str(currVe))

    plt.plot(time, y[:,1])
    plt.show()

</code></pre><p class="css-19iowwu">Since NumPy uses double precision floats by default, we are unlikely to run into difficulty with compounding truncation errors while reaching the requested accuracy threshold. This code takes approximately 0.29s to run on my machine. </p><p class="css-19iowwu">Output from NumPy:</p><pre class="css-mwhsaa"><code class="css-tej46y">Final exit velocity: 20.5351500922157
Total time for question 4: 0.07754755020141602
</code></pre><p class="css-19iowwu"><img src="%5Crocketvelocitypng" alt="RocketVelocity.png" class="css-1k89gbo"/></p><h2 class="css-cq6ij1">Question 5 - BVP</h2><p class="css-19iowwu">The most straightforward approach to solving BVPs is a method known as the shooting method. After solving question 4 above, I was quite excited to simply power on and solve this one directly as well. However, once I remembered the constraints of this exam (no IVP/BVP solvers for ODEs, obviously, but also no fsolve or similar for nonlinear systems!), I realized the amount of work necessary would be quite a bit. I&#x27;m still working the solution for fun on my own time, but this is the procedure we&#x27;ll follow:</p><p class="css-19iowwu">1) Rewrite the given ODE as a system of first-order ODEs, e.g. $$y<em class="css-0">1&#x27; = y_2$$ $$ y_2&#x27; = y_1^3 - y$$<br/>2) Initialize this system with the one given &#x27;initial&#x27; boundary condition, i.e. $$y_1(0) = 1$$ Treat the second initial value y2(0) as a freely specified variable (we&#x27;ll call it V).
3) These next steps are performed iteratively, until the desired solution accuracy is reached.
1) Integrate the system with a suitable method (RK4 above works well) from the generated initial conditions $$ \hat{y}_0 = <!-- -->[y(0), V]<!-- -->$$
2) &#x27;Score&#x27; the solution according to the discrepancy at the &#x27;other end&#x27;, i.e. $$F = y_1(20) + 1$$
3) If |F| is sufficiently small, stop.
4) Find an adjustment to V as $$V</em>{new} = V<em class="css-0">{old} + dV$$ $$JdV = -F$$ J here is the Jacobian of F wrt V, eg $$J</em>{ij} = \frac{dF_i}{dV_j}$$ These elements of the Jacobian must be solved for with dim(V) more integrations of the ODE system, again via RK4 or similar.
5) Repeat from step 3.1 with new initial conditions: $$ \hat{y}_0 = <!-- -->[y_1(0), Vnew]<!-- -->$$</p><p class="css-19iowwu">The above described procedure is the shooting method, utilizing the Newton-Rhapson procedure to iteratively solve for the set of &#x27;initial&#x27; boundary values which cause F to be (near) zero. By adding a function to the code from question 3 to automatically differentiate F to generate J (with more forward integration from perturbed starting points), we could solve this quite readily. Details can be found in chapter 18 of &quot;Numerical Recipes: The Art of Scientific Computing&quot; by Press et al. </p><h2 class="css-cq6ij1">Actually, we have a solution...</h2><p class="css-19iowwu">After writing that last paragraph, I decided it wasn&#x27;t terribly difficult to simply go ahead and amend the Newton-Rhapson procedure from question 3 and went ahead and solved the problem. Code, output, and plot are below. I did have to play with the initial guess and the tuning for the numerical Jacobian procedure a bit, as this equation seems quite stiff. A better ODE integration technique with an adaptive step size would likely have made this significantly easier. </p><pre class="css-mwhsaa"><code class="css-tej46y">## Problem 5: BVP 
## y&#x27;&#x27; = y^3 - y, y(0) = 1, y(20) = -1

## Here we use the shooting method. First, decompose to two first order odes
## y1&#x27; = y2
## y2&#x27; = y1^3 - y1
## IVs: y1[0] = 1, y2[0] = free
## Integrate with RK4, check y1[20], correct and repeat. 

def derivativesq5(t, yn):
    out = np.zeros((2,))
    out[0] = yn[1]
    out[1] = yn[0]**3 - yn[0]

    return out

def Score_q5(v):
    nsteps = 5000
    #print(v)
    x = np.linspace(0,20,nsteps)
    dx = x[2] - x[1]
    y = np.zeros((nsteps,2))
    y[0,0] = 1
    y[0,1] = v

    for i in range(1, nsteps):
        y[i,:] = integrate(y[i-1,:], x[i-1], dx, derivativesq5, 2)

    out = y[-1,0] + 1
    # plt.plot(x,y)
    # plt.show()
    return np.array([out], dtype=np.dtype(np.float64))

def Jacobian_q5(v):
    # Complex step differentiation would likely be much more accurate here
    vnew = v*2.0
    perturb = vnew-v

    out = (Score_q5(vnew) - Score_q5(v))/perturb
    return np.array([out], dtype=np.dtype(np.float64))

def question5():
    #Score_q5(-0.01)
    xstar = newtonRhapsonND(np.array([-0.0000001]), Score_q5, Jacobian_q5)
    nsteps = 5000
    x = np.linspace(0,20,nsteps)
    dx = x[2] - x[1]
    y = np.zeros((nsteps, 2))
    y[0,0] = 1
    y[0,1] = xstar[0]

    for i in range(1, nsteps):
        y[i,:] = integrate(y[i-1,:], x[i-1], dx, derivativesq5, 2)

    if plots:
        plt.plot(x,y)
        plt.xlabel(&quot;X&quot;)
        plt.ylabel(&quot;Y&quot;)
        plt.title(&quot;y&#x27;&#x27; = y^3 - y, y(0) = 1, y(20) = -1&quot;)
        plt.legend([&quot;Y_1&quot;, &quot;Y_2&quot;])
        plt.show()

t0 = time.time()
question5()
t1 = time.time()
print(f&quot;Total time for question 5: {t1-t0}.&quot;)
</code></pre><pre class="css-mwhsaa"><code class="css-tej46y">Total time for question 5: 12.914722204208374.
</code></pre><p class="css-19iowwu"><img src="%5Cbvppng" alt="BVP.png" class="css-1k89gbo"/></p></div><style data-emotion-css="rl6otz">.css-rl6otz{border-radius:8px;}</style><style data-emotion-css="19qk7ja">.css-19qk7ja{box-sizing:border-box;margin:0;min-width:0;padding:16px;margin-bottom:8px;background-color:#fafafc;color:#718096;border-radius:8px;}</style><div class="css-19qk7ja"><style data-emotion-css="1cev0y9">.css-1cev0y9{margin:0;font-size:14px;}</style><p class="css-1cev0y9">If you think this note resonated, be it positive or negative, send me a<!-- --> <style data-emotion-css="15vz5gh">.css-15vz5gh{-webkit-text-decoration:underline;text-decoration:underline;color:#718096;}</style><style data-emotion-css="lnu7pe">.css-lnu7pe{color:#3182ce;-webkit-text-decoration:none;text-decoration:none;-webkit-text-decoration:underline;text-decoration:underline;color:#718096;}.css-lnu7pe:hover{-webkit-text-decoration:underline;text-decoration:underline;}</style><a href="https://twitter.com/messages/compose?recipient_id=" class="css-lnu7pe">direct message</a> <!-- -->on Twitter or an<!-- --> <a href="#" class="css-lnu7pe">email</a> <!-- -->and we can talk.</p></div></div></div></div></div></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/\575a-final-exam";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-504a3d583955b68254fc.js"],"app":["/app-c896d5c9f10e2f28f960.js"],"component---node-modules-gatsby-theme-andy-src-templates-note-js":["/component---node-modules-gatsby-theme-andy-src-templates-note-js-49a4cf68cd149593e30e.js"]};/*]]>*/</script><script src="/polyfill-504a3d583955b68254fc.js" nomodule=""></script><script src="/component---node-modules-gatsby-theme-andy-src-templates-note-js-49a4cf68cd149593e30e.js" async=""></script><script src="/styles-29163f9dced6fe4a408a.js" async=""></script><script src="/app-c896d5c9f10e2f28f960.js" async=""></script><script src="/framework-66ce1c6e8de1b4304605.js" async=""></script><script src="/webpack-runtime-686ea3609d93a4d6222a.js" async=""></script></body></html>